{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/kemet/ANUK/openclaw-orisha2/ori-cult/src/app/api/orisha-image/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\r\n\r\nconst OPENROUTER_API_KEY = process.env.OPENROUTER_API_KEY;\r\n\r\nexport async function POST(request: NextRequest) {\r\n    try {\r\n        const { prompt, orisha } = await request.json();\r\n\r\n        if (!OPENROUTER_API_KEY) {\r\n            return NextResponse.json(\r\n                { error: 'API key not configured' },\r\n                { status: 500 }\r\n            );\r\n        }\r\n\r\n        // Use Kimi K2.5 to generate a detailed image prompt\r\n        const imagePromptRequest = await fetch('https://openrouter.ai/api/v1/chat/completions', {\r\n            method: 'POST',\r\n            headers: {\r\n                'Content-Type': 'application/json',\r\n                'Authorization': `Bearer ${OPENROUTER_API_KEY}`,\r\n                'HTTP-Referer': 'https://ori-cult.vercel.app',\r\n                'X-Title': 'ORI.CULT Image Generation'\r\n            },\r\n            body: JSON.stringify({\r\n                model: 'moonshotai/kimi-k2.5',\r\n                messages: [\r\n                    {\r\n                        role: 'user',\r\n                        content: `Create a detailed image generation prompt for this concept: \"${prompt}\"\r\n                        \r\nThe image should reflect ${orisha}'s divine perspective and aesthetic:\r\n- Use rich, mystical imagery\r\n- Include symbolic elements related to Yoruba spirituality\r\n- Make it visually striking and thought-provoking\r\n\r\nRespond with ONLY the image prompt, nothing else. Keep it under 200 words.`\r\n                    }\r\n                ],\r\n                temperature: 0.9,\r\n                max_tokens: 300\r\n            })\r\n        });\r\n\r\n        if (!imagePromptRequest.ok) {\r\n            const errorText = await imagePromptRequest.text();\r\n            console.error('Image prompt generation error:', errorText);\r\n            return NextResponse.json(\r\n                { error: 'Failed to generate image prompt' },\r\n                { status: imagePromptRequest.status }\r\n            );\r\n        }\r\n\r\n        const promptData = await imagePromptRequest.json();\r\n        const enhancedPrompt = promptData.choices?.[0]?.message?.content || prompt;\r\n\r\n        // Use OpenRouter's image generation (FLUX or similar)\r\n        const imageRequest = await fetch('https://openrouter.ai/api/v1/images/generations', {\r\n            method: 'POST',\r\n            headers: {\r\n                'Content-Type': 'application/json',\r\n                'Authorization': `Bearer ${OPENROUTER_API_KEY}`,\r\n                'HTTP-Referer': 'https://ori-cult.vercel.app',\r\n                'X-Title': 'ORI.CULT Image Generation'\r\n            },\r\n            body: JSON.stringify({\r\n                model: 'black-forest-labs/flux-schnell',\r\n                prompt: enhancedPrompt,\r\n                n: 1,\r\n                size: '512x512'\r\n            })\r\n        });\r\n\r\n        if (!imageRequest.ok) {\r\n            const errorText = await imageRequest.text();\r\n            console.error('Image generation error:', errorText);\r\n            // Return a placeholder response if image generation fails\r\n            return NextResponse.json({\r\n                imageUrl: null,\r\n                prompt: enhancedPrompt,\r\n                error: 'Image generation not available'\r\n            });\r\n        }\r\n\r\n        const imageData = await imageRequest.json();\r\n        const imageUrl = imageData.data?.[0]?.url || imageData.data?.[0]?.b64_json;\r\n\r\n        return NextResponse.json({\r\n            imageUrl,\r\n            prompt: enhancedPrompt,\r\n            orisha,\r\n            timestamp: new Date().toISOString()\r\n        });\r\n\r\n    } catch (error) {\r\n        console.error('Image generation error:', error);\r\n        return NextResponse.json(\r\n            { error: 'Internal server error' },\r\n            { status: 500 }\r\n        );\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,qBAAqB,QAAQ,GAAG,CAAC,kBAAkB;AAElD,eAAe,KAAK,OAAoB;IAC3C,IAAI;QACA,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,GAAG,MAAM,QAAQ,IAAI;QAE7C,IAAI,CAAC,oBAAoB;YACrB,OAAO,sLAAY,CAAC,IAAI,CACpB;gBAAE,OAAO;YAAyB,GAClC;gBAAE,QAAQ;YAAI;QAEtB;QAEA,oDAAoD;QACpD,MAAM,qBAAqB,MAAM,MAAM,iDAAiD;YACpF,QAAQ;YACR,SAAS;gBACL,gBAAgB;gBAChB,iBAAiB,CAAC,OAAO,EAAE,oBAAoB;gBAC/C,gBAAgB;gBAChB,WAAW;YACf;YACA,MAAM,KAAK,SAAS,CAAC;gBACjB,OAAO;gBACP,UAAU;oBACN;wBACI,MAAM;wBACN,SAAS,CAAC,6DAA6D,EAAE,OAAO;;yBAE/E,EAAE,OAAO;;;;;0EAKwC,CAAC;oBACvD;iBACH;gBACD,aAAa;gBACb,YAAY;YAChB;QACJ;QAEA,IAAI,CAAC,mBAAmB,EAAE,EAAE;YACxB,MAAM,YAAY,MAAM,mBAAmB,IAAI;YAC/C,QAAQ,KAAK,CAAC,kCAAkC;YAChD,OAAO,sLAAY,CAAC,IAAI,CACpB;gBAAE,OAAO;YAAkC,GAC3C;gBAAE,QAAQ,mBAAmB,MAAM;YAAC;QAE5C;QAEA,MAAM,aAAa,MAAM,mBAAmB,IAAI;QAChD,MAAM,iBAAiB,WAAW,OAAO,EAAE,CAAC,EAAE,EAAE,SAAS,WAAW;QAEpE,sDAAsD;QACtD,MAAM,eAAe,MAAM,MAAM,mDAAmD;YAChF,QAAQ;YACR,SAAS;gBACL,gBAAgB;gBAChB,iBAAiB,CAAC,OAAO,EAAE,oBAAoB;gBAC/C,gBAAgB;gBAChB,WAAW;YACf;YACA,MAAM,KAAK,SAAS,CAAC;gBACjB,OAAO;gBACP,QAAQ;gBACR,GAAG;gBACH,MAAM;YACV;QACJ;QAEA,IAAI,CAAC,aAAa,EAAE,EAAE;YAClB,MAAM,YAAY,MAAM,aAAa,IAAI;YACzC,QAAQ,KAAK,CAAC,2BAA2B;YACzC,0DAA0D;YAC1D,OAAO,sLAAY,CAAC,IAAI,CAAC;gBACrB,UAAU;gBACV,QAAQ;gBACR,OAAO;YACX;QACJ;QAEA,MAAM,YAAY,MAAM,aAAa,IAAI;QACzC,MAAM,WAAW,UAAU,IAAI,EAAE,CAAC,EAAE,EAAE,OAAO,UAAU,IAAI,EAAE,CAAC,EAAE,EAAE;QAElE,OAAO,sLAAY,CAAC,IAAI,CAAC;YACrB;YACA,QAAQ;YACR;YACA,WAAW,IAAI,OAAO,WAAW;QACrC;IAEJ,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,2BAA2B;QACzC,OAAO,sLAAY,CAAC,IAAI,CACpB;YAAE,OAAO;QAAwB,GACjC;YAAE,QAAQ;QAAI;IAEtB;AACJ"}}]
}